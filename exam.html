<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EDAI Tutor Exam Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      color: #1d3557;
    }
    h2 {
      text-align: center;
      color: #457b9d;
      font-size: 1rem;
      margin-bottom: 1rem;
    }
    .question {
      margin-bottom: 25px;
      padding: 15px;
      border-radius: 10px;
      background: #f9f9f9;
      border: 1px solid #dee2e6;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #0056b3;
    }
    .correct { color: green; font-weight: bold; }
    .incorrect { color: red; font-weight: bold; }
    .explanation {
      background: #e9f7ef;
      border-left: 4px solid #28a745;
      padding: 8px 12px;
      margin-top: 8px;
      border-radius: 5px;
      font-size: 0.9rem;
    }
    .load-more {
      display: block;
      margin: 20px auto;
      background-color: #1d3557;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>EDAI Tutor Exam Generator</h1>
    <h2>ACEM / RCEM / RNZCUC / Associateship Mock Exam Practice</h2>
    <div id="questions"></div>
    <button id="loadMore" class="load-more">Load 20 More Questions</button>
  </div>

  <script>
    const questionURL = "https://paramson.github.io/edaitutor-exam-bank/questions_bank.json";
    const explanationURL = "https://paramson.github.io/edaitutor-exam-bank/explanations_bank.json";
    let questions = [];
    let explanations = {};
    let currentIndex = 0;
    const batchSize = 20;

    async function loadQuestions() {
      try {
        const [qRes, eRes] = await Promise.all([
          fetch(questionURL),
          fetch(explanationURL)
        ]);

        if (!qRes.ok || !eRes.ok) throw new Error("File fetch error");

        questions = await qRes.json();
        explanations = await eRes.json();
        renderNextBatch();
      } catch (err) {
        document.getElementById("questions").innerHTML = 
          `<p style="color:red;">Failed to load questions or explanations. Please check file paths.</p>`;
        console.error(err);
      }
    }

    function renderNextBatch() {
      const container = document.getElementById("questions");
      const nextBatch = questions.slice(currentIndex, currentIndex + batchSize);
      nextBatch.forEach((q, i) => {
        const qDiv = document.createElement("div");
        qDiv.className = "question";
        qDiv.innerHTML = `
          <p><b>Q${currentIndex + i + 1}. ${q.stem}</b></p>
          ${q.options.map((opt, j) => `
            <label><input type="radio" name="${q.id}" value="${j}"> ${opt}</label><br>
          `).join("")}
          <button onclick="checkAnswer('${q.id}', ${q.answer_index})">Check</button>
          <div id="exp-${q.id}" class="explanation" style="display:none;"></div>
        `;
        container.appendChild(qDiv);
      });
      currentIndex += nextBatch.length;
    }

    function checkAnswer(id, correctIndex) {
      const radios = document.querySelectorAll(`input[name="${id}"]`);
      let selectedIndex = -1;
      radios.forEach((r, i) => { if (r.checked) selectedIndex = i; });
      const expDiv = document.getElementById(`exp-${id}`);

      if (selectedIndex === -1) {
        expDiv.style.display = "block";
        expDiv.innerHTML = "<span class='incorrect'>Please select an answer.</span>";
        return;
      }

      const result = selectedIndex === correctIndex ? 
        "<span class='correct'>‚úÖ Correct!</span>" : 
        "<span class='incorrect'>‚ùå Incorrect.</span>";

      const expData = explanations[id];
      const expText = expData ? 
        `${expData.text}<br><b>References:</b><br>${expData.sources.map(s => `<a href="${s.url}" target="_blank">${s.title}</a>`).join("<br>")}` :
        "Explanation not available.";

      expDiv.style.display = "block";
      expDiv.innerHTML = `${result}<br>${expText}`;
    }

    document.getElementById("loadMore").addEventListener("click", () => {
      if (currentIndex < questions.length) {
        renderNextBatch();
      } else {
        alert("üéâ You‚Äôve reached the end of the question bank!");
      }
    });

    loadQuestions();
  </script>
</body>
</html>






